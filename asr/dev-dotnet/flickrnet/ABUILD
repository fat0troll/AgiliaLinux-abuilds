#ABUILD created by/создан: fat0troll, fat0troll at riseup.net 
#----------------------------- General vars --------------------------------------
#------------------------- Основные переменные -----------------------------------
pkgname=flickrnet
pkgver=2.2.0
pkgbuild=1
arch=('auto')

shortdesc="Flickr.Net API Library"
#-ruler---|--------------------------------------------------------------------------|
longdesc=("he Flickr.Net API Library is a .Net Library for accessing the Flickr API. It is written entirely in C# it can be accessed from the .Net Framework 2.0 and above, .Net Compact Framework 2.0 SP1 and above, Silverlight 3.0 and above, Windows 7 Phone, Mono and Monotouch for iPhone"
)

source=("https://launchpad.net/ubuntu/+archive/primary/+files/lib${pkgname}_${pkgver}.orig.tar.gz")

patch_opts=("")

#----------------------------- AgiliaLinux vars --------------------------------------
#--------------------- Специфичные для AgiliaLinux ------------------------------
#short and long tags / длинный и короткий тег
tags="develop dev-dotnet"

#dependencies only needed to build package
build_deps=""

provides=""
conflicts=""

adddep=""
removedep=""

#for multi pkg abuild
pkglist=

#Set number of jobs while compliling, otherwise it'll be autodetected
#numjobs=1

#additional files should be copied into /usr/docs/${pkgname} dir from sources
docs=
gendeps_blacklist=

#custom_opts: skip_validate skip_gendeps no_postperm no_strip
custom_opts=""

#----------------------------- Make PKG --------------------------------------
#-------------------------- Сборка пакета ------------------------------------

#ran before function build()
#запускается перед сборкой
before_build()
{
echo ""
}

build()
{
go_src_dir
export MONO_SHARED_DIR="$srcdir/.wabi"
mkdir -p "${MONO_SHARED_DIR}"
cd $srcdir/libflickrnet-48055~2.2.0/FlickrNet
patch -Np0 -i $filedir/AssemblyInfo.patch
gmcs -target:library -out:FlickrNet.dll -r:System.Web.dll -r:System.Drawing.dll *.cs || return 1
install -Dm644 FlickrNet.dll $pkgdir/usr/lib$LIBDIRSUFFIX/mono/flickrnet-$pkgver/FlickrNet.dll

install -Dm644 $filedir/flickrnet.pc $pkgdir/usr/lib$LIBDIRSUFFIX/pkgconfig/flickrnet.pc
sed -i "s/@VERSION@/$pkgver/" $pkgdir/usr/lib$LIBDIRSUFFIX/pkgconfig/flickrnet.pc

}


#ran after function build() 
#после сборки
after_build()
{
cd $pkgdir/usr
cp -R lib$LIBDIRSUFFIX lib
}
