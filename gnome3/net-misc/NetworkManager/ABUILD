# ABUILD generated by spkg2abuild converter from NetworkManager-0.8-4.spkg

# Package metadata
pkgname=NetworkManager
pkgver=0.8.998
pkgbuild=1
arch=("auto")

config_files="etc/NetworkManager/NetworkManager.conf"
# Package description
shortdesc=('Network Management daemon')
longdesc=('Network Management daemon')

# Source URL
#source=("http://ftp.gnome.org/pub/gnome/sources/NetworkManager/0.8/NetworkManager-${pkgver}.tar.bz2")
source=("git:git://cgit.freedesktop.org/NetworkManager/NetworkManager.git")

# Tags
tags=("network net-misc")

# Manually-added dependencies
adddep="ppp>=2.4.5 iptables dhcpcd wireless-tools wpa_supplicant rp-pppoe"

# Build system
BUILD_SYSTEM="autotools"

BUILD_WORD="./autogen.sh"

BUILD_KEYS="--prefix=/usr \
--bindir=/usr/bin \
--sbindir=/usr/sbin \
--includedir=/usr/include \
--mandir=/usr/man \
--infodir=/usr/info \
--libdir=/usr/lib$LIBDIRSUFFIX \
--sysconfdir=/etc \
--localstatedir=/var \
--libexecdir=/usr/lib$LIBDIRSUFFIX/networkmanager \
--with-iptables=/usr/sbin/iptables \
--enable-more-warnings=no \
--disable-static \
--with-dhcpcd=/sbin/dhcpcd \
--with-dhclient=no \
--with-crypto=gnutls \
--with-distro=slackware"
INSTALL_KEYS="DESTDIR=${pkgdir}"

after_build() {
	install -m644 "${filedir}/NetworkManager.conf" "${pkgdir}/etc/NetworkManager/" || exit 1

	# we don't need these docs
	rm -rf ${pkgdir}/usr/share/gtk-doc
	
	mkdir -p ${pkgdir}/etc/init.d
	install -m755 ${filedir}/init.d/networkmanager ${pkgdir}/etc/init.d/networkmanager

	# Remove old rc.d scripts, we don't need this
	rm ${pkgdir}/etc/rc.d/rc.networkmanager
	rmdir ${pkgdir}/etc/rc.d
}

